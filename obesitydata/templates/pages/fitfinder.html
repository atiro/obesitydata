{% extends "base.html" %}

{% load static %}

{% load nvd3_tags %}

{% block css %}
{{ block.super  }}

<link media="all" href="{% static 'nvd3/build/nv.d3.css' %}" type="text/css" rel="stylesheet" />

{% endblock %}

{% block javascript %}

{{ block.super }}

<script type="text/javascript" src='{% static 'd3/d3.min.js' %}'></script>
<script type="text/javascript" src='{% static 'nvd3/build/nv.d3.min.js' %}'></script>

<script type="text/javascript">

var gender;
var age;

$(document).ready(function() {
	$('body').on('click', '#gender button', function() {
		$(this).toggleClass('active');

	// Load graph with URL based on buttons

	gender = $('.gender button.active').val();

	var json_url = '/diagnosis/admissions/gender/primary/' + gender;

	d3.json(json_url, function(data) {
		nv.addGraph(function() {
			var chart = nv.models.stackedAreaChart()
				.x(function(d) { return d[0] })
				.y(function(d) { return d[1] })
				.showControls(false)
				.clipEdge(true);

			chart.xAxis.tickFormat(function(d) {
				return d3.time.format('%x')(new Date(d))
			});

			// Chart setup TODO

			d3.select('#c-gender svg')
				.datum(data)
				.call(chart);

			$('#s-gender').text(data[0].summary)

			nv.utils.windowResize(chart.update);

			return chart;
		});
	});

	$('#g-gender').removeClass('hide')
	$('#i-gender').removeClass('hide')
	$('#q-age').removeClass('hide')

	});

$('body').on('click', '#age button', function() {
	$(this).toggleClass('active');

	age = $('.age button.active').val();

	var json_url = '/diagnosis/admissions/age/primary/' + age;

	d3.json(json_url, function(data) {
		nv.addGraph(function() {
			var chart = nv.models.stackedAreaChart()
				.x(function(d) { return d[0] })
				.y(function(d) { return d[1] })
				.showControls(false)
				.clipEdge(true);

			chart.xAxis.tickFormat(function(d) {
				return d3.time.format('%x')(new Date(d))
			});

			// Chart setup TODO

			d3.select('#c-age svg')
				.datum(data)
				.call(chart);

			$('#s-age').text(data[0].summary)

			nv.utils.windowResize(chart.update);

			return chart;
		});
	});

	$('#g-age').removeClass('hide')
	$('#i-age').removeClass('hide')
	$('#q-activity').removeClass('hide')
	});

$('#activity').on('click', function(e) {

	d3.json('/health/activity/', function(data) {
		nv.addGraph(function() {
			var chart = nv.models.stackedAreaChart()
				.x(function(d) { return d[0] })
				.y(function(d) { return d[1] })
				.showControls(false)
				.clipEdge(true);

			chart.xAxis.tickFormat(function(d) {
				return d3.time.format('%x')(new Date(d))
			});

			// Chart setup TODO

			d3.select('#c-activity svg')
				.datum(data)
				.call(chart);

			nv.utils.windowResize(chart.update);

			return chart;
		});
	});

	$('#g-activity').removeClass('hide')
	$('#i-activity').removeClass('hide')
	$('#q-diet').removeClass('hide')
	});

$('#diet').on('click', function(e) {

	d3.json('/health/diet/', function(data) {
		nv.addGraph(function() {
			var chart = nv.models.stackedAreaChart()
				.x(function(d) { return d[0] })
				.y(function(d) { return d[1] })
				.showControls(false)
				.clipEdge(true);

			chart.xAxis.tickFormat(function(d) {
				return d3.time.format('%x')(new Date(d))
			});

			// Chart setup TODO

			d3.select('#c-diet svg')
				.datum(data)
				.call(chart);

			nv.utils.windowResize(chart.update);

			return chart;
		});
	});

	$('#g-diet').removeClass('hide')
	$('#i-diet').removeClass('hide')
	$('#q-alcohol').removeClass('hide')
	});
});


</script>

{% endblock %}

{% block content %}


<div class="col-md-3">
	<div id="g-gender" class="hide">
		<div id="c-gender">
			    <svg style="height: 200px;"></svg>
		</div>
		<div id="i-gender">
		<span id="s-gender"></span>
		<span>See full <a href="/diagnosis/admissions/gender/primary">details</a></span>
		</div>
	</div>
	<div id="g-activity" class="hide" style="padding-top: 100px;">
		<div id="c-activity">
			    <svg style="height: 200px;"></svg>
		</div>
	</div>
</div>

<div class="col-md-6">
<div>
<h1>Find My Fit</h1>
</div>

	<h4>Your Gender</h4>
	<div id="q-gender">
<div class="btn-group gender" role="group" id="gender" data-toggle="buttons-radio" style="padding-bottom: 20px;">
<button id="a-male" type="button" class="btn btn-primary" value="M">Male</button>
<button id="a-female" type="button" class="btn btn-success" value="F">Female</button>
</div>

	</div>

	<div id="q-age" class="hide">
	<h4>Your Age</h4>
<div class="btn-group age" role="group" id="age">
<button type="button" class="btn btn-default" value="0-16">0-16</button>
<button type="button" class="btn btn-primary" value="16-24">16-24</button>
<button type="button" class="btn btn-success" value="25-34">25-34</button>
<button type="button" class="btn btn-info" value="35-44">35-44</button>
<button type="button" class="btn btn-warning" value="45-54">45-54</button>
<button type="button" class="btn btn-danger" value="55-64">55-64</button>
<button type="button" class="btn btn-danger" value="65-74">65-74</button>
<button type="button" class="btn btn-danger" value="75+">Over 75</button>
	</div>
	</div>

	<div id="q-activity" class="hide">
	<h4>Your Activity</h4>
<div class="btn-group activity" role="group" id="activity">
<button type="button" class="btn btn-default">Meets</button>
<button type="button" class="btn btn-primary">Some</button>
<button type="button" class="btn btn-success">Low</button>
</div>
	</div>


	<div id="q-diet" class="hide">
<h3>Your Diet (Fruit/Veg Portions a day)</h3>
<div class="btn-group diet" role="group" id="diet">
<button type="button" class="btn btn-default">None</button>
<button type="button" class="btn btn-primary">0-1</button>
<button type="button" class="btn btn-success">1-2</button>
<button type="button" class="btn btn-info">2-3</button>
<button type="button" class="btn btn-warning">3-4</button>
<button type="button" class="btn btn-danger">4-5</button>
	</div>
	</div>

	<div id="q-alcohol" class="hide">
<h3>Your Alcohol</h3>
	</div>

	<div id="q-smoking" class="hide">
<h3>Your Smoking</h3>
	</div>

	<div id="q-green" class="hide">
<h3>My Green Space (opt)</h3>
	Enter your postcode:
	</div>

</div>
<div class="col-md-3">
	<div id="g-age" class="hide" style="padding-top: 100px;">
		<div id="c-age">
			    <svg style="height: 200px;"></svg>
		</div>
	</div>
	<div id="i-age" class="hide">
		<span id="s-age"></span>
		<span>See more details</div>
</div>
	<div id="i-activity" class="hide">Info Activity</div>
	<div id="g-diet" class="hide" style="padding-top: 100px;">
		<div id="c-diet">
			    <svg style="height: 200px;"></svg>
		</div>
	</div>
</div>

{% endblock %}
